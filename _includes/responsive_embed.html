{% comment %}
  Embeds a responsive iframe for a Google Drive link from front matter.
  - Handles page.drive_link for embedding.
  - Optionally shows a description and download button.
{% endcomment %}

{%- assign embed_src = "" -%}
{%- assign download_href = "" -%}
{%- assign embed_class = "responsive-embed-container" -%}

{%- if page.drive_link -%}
  {%- assign file_id = page.drive_link | split: '/d/' | last | split: '/' | first -%}
  {%- if page.drive_link contains '/presentation/' -%}
    {%- assign embed_src = "https://docs.google.com/presentation/d/" | append: file_id | append: "/embed?start=false&loop=false&delayms=3000" -%}
  {%- else -%}
    {%- assign embed_src = "https://drive.google.com/file/d/" | append: file_id | append: "/preview" -%}
    {%- assign embed_class = "responsive-embed-container responsive-embed-container--portrait" -%}
  {%- endif -%}
  {%- assign download_href = "https://drive.google.com/uc?export=download&id=" | append: file_id -%}
{%- endif -%}

{%- assign has_header = false -%}
{%- if page.embed_description or download_href != "" -%}
  {%- assign has_header = true -%}
{%- endif -%}

{% if embed_src != "" %}
  {% if has_header %}
    <div class="embed-header">
      {% if page.embed_description %}
        <p>{{ page.embed_description }}</p>
      {% endif %}
      {% if download_href != "" %}
        <a href="{{ download_href }}" class="btn btn--primary" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
      {% endif %}
    </div>
  {% endif %}

  <div class="{{ embed_class }}">
    <iframe src="{{ embed_src }}" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true"></iframe>
  </div>
{% endif %}
